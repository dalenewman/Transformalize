(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("./foldcode")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","./foldcode"],n):n(CodeMirror)})(function(n){"use strict";function h(n){this.options=n;this.from=this.to=0}function c(n){return n===!0&&(n={}),n.gutter==null&&(n.gutter="CodeMirror-foldgutter"),n.indicatorOpen==null&&(n.indicatorOpen="CodeMirror-foldgutter-open"),n.indicatorFolded==null&&(n.indicatorFolded="CodeMirror-foldgutter-folded"),n}function l(n,t){for(var r=n.findMarksAt(u(t)),i=0;i<r.length;++i)if(r[i].__isFold&&r[i].find().from.line==t)return!0}function f(n){if(typeof n=="string"){var t=document.createElement("div");return t.className=n+" CodeMirror-guttermarker-subtle",t}return n.cloneNode(!0)}function i(t,i,r){var e=t.state.foldGutter.options,o=i;t.eachLine(i,r,function(i){var r=null;if(l(t,o))r=f(e.indicatorFolded);else{var c=u(o,0),h=e.rangeFinder||n.fold.auto,s=h&&h(t,c);s&&s.from.line+1<s.to.line&&(r=f(e.indicatorOpen))}t.setGutterMarker(i,e.gutter,r);++o})}function t(n){var t=n.getViewport(),r=n.state.foldGutter;r&&(n.operation(function(){i(n,t.from,t.to)}),r.from=t.from,r.to=t.to)}function e(n,t,i){var r=n.state.foldGutter.options;i==r.gutter&&n.foldCode(u(t,0),r.rangeFinder)}function o(n){var i=n.state.foldGutter,r=n.state.foldGutter.options;i.from=i.to=0;clearTimeout(i.changeUpdate);i.changeUpdate=setTimeout(function(){t(n)},r.foldOnChangeTimeSpan||600)}function s(n){var r=n.state.foldGutter,u=n.state.foldGutter.options;clearTimeout(r.changeUpdate);r.changeUpdate=setTimeout(function(){var u=n.getViewport();r.from==r.to||u.from-r.to>20||r.from-u.to>20?t(n):n.operation(function(){u.from<r.from&&(i(n,u.from,r.from),r.from=u.from);u.to>r.to&&(i(n,r.to,u.to),r.to=u.to)})},u.updateViewportTimeSpan||400)}function r(n,t){var u=n.state.foldGutter,r=t.line;r>=u.from&&r<u.to&&i(n,r,r+1)}n.defineOption("foldGutter",!1,function(i,u,f){if(f&&f!=n.Init&&(i.clearGutter(i.state.foldGutter.options.gutter),i.state.foldGutter=null,i.off("gutterClick",e),i.off("change",o),i.off("viewportChange",s),i.off("fold",r),i.off("unfold",r),i.off("swapDoc",t)),u){i.state.foldGutter=new h(c(u));t(i);i.on("gutterClick",e);i.on("change",o);i.on("viewportChange",s);i.on("fold",r);i.on("unfold",r);i.on("swapDoc",t)}});var u=n.Pos});
//# sourceMappingURL=foldgutter.min.js.map
